<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:sec="http://www.w3.org/1999/xhtml"
      layout:decorate="~{layouts/default}">
<head>
	<meta charset="utf-8">
  <title>All events</title>
  <meta name='viewport' content='width=device-width, initial-scale=1' />
    <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v2.13.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v2.13.0/mapbox-gl.css' rel='stylesheet' />
    <style>
      body {
        margin: 0;
        padding: 0;
      }

      #map {
        position: absolute;
        top: 0;
        bottom: 0;
        width: 100%;
      }
    </style>

</head>
<body>
  <div layout:fragment="content">
    <h1>All events
        <td sec:authorize="isAuthenticated()">
            <a href="/events/add" class="btn btn-success btn-sm"><i class="fas fa-plus"></i> Add new</a>
        </td>
        <form action="events/search" style="margin-top: -40px; margin-bottom: 8px; width: 63%" method="get">
            <label for="search-input"></label>
            <div class="input-group">
                <input
                        type="text"
                        id="search-input"
                        name="q"
                        class="form-control col-md-5"
                        placeholder="Enter your words"
                />
                <div class="input-group-append">
                    <button type="submit" class="btn btn-primary">Search</button>
                </div>
            </div>
        </form>
    </h1>

    <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th><i class="fas fa-bolt"></i> Event</th>
            <th><i class="fas fa-map-marker-alt"></i> Venue</th>
            <th><i class="fas fa-calendar"></i> Date</th>
            <th style="text-align: center"><i class="fas fa-clock"></i> Time</th>
            <th sec:authorize="isAuthenticated()"><i class="fas fa-edit"></i> Manage</th>
          </tr>
        </thead>

        <tbody>
          <th:block th:if="${upcomingEvents.iterator().hasNext()}">
            <tr>
              <td colspan="6" style="text-align: center; font-weight: bold;">Upcoming Events</td>
            </tr>
          </th:block>
          <tr th:each="e : ${upcomingEvents}">
            <td><a th:href="@{/events/description(id=${e.id})}" th:text="${e.name}">See more</a></td>
            <td th:text="${e.venue.name}">Event venue</td>
            <td th:text="${{e.date}}">Event date</td>
            <td style="text-align: center" th:text="${{e.time}}">Event time</td>
            <td sec:authorize="isAuthenticated()">
              <a th:href="@{/events/edit/{id}(id=${e.id})}" class="btn btn-primary btn-sm">
                <i class="fas fa-edit"></i> Edit
              </a>
            </td>
          </tr>
          <th:block th:if="${previousEvents.iterator().hasNext()}">
            <tr>
              <td colspan="6" style="text-align: center; font-weight: bold;">Previous Events</td>
            </tr>
          </th:block>
          <tr th:each="e : ${previousEvents}">
            <td><a th:href="@{/events/description(id=${e.id})}" th:text="${e.name}">See more</a></td>
            <td th:text="${e.venue.name}">Event venue</td>
            <td th:text="${{e.date}}">Event date</td>
            <td style="text-align: center" th:text="${{e.time}}">Event time</td>
            <td sec:authorize="isAuthenticated()">
              <a th:href="@{/events/edit/{id}(id=${e.id})}" class="btn btn-primary btn-sm">
                <i class="fas fa-edit"></i> Edit
              </a>
            </td>
            </tr>
        </tbody>
      </table>
       <div id="map"></div>
 
	<script>
		// TO MAKE THE MAP APPEAR YOU MUST
		// ADD YOUR ACCESS TOKEN FROM
		// https://account.mapbox.com
		mapboxgl.accessToken = 'pk.eyJ1IjoiN3Nlbmxpbi1taWFvIiwiYSI6ImNsZjhnOTBnNTBncm4zc252anM4ZHhmYmEifQ.8Xkazn-qXfFkT0yk_SDb8g';
	const map = new mapboxgl.Map({
	container: 'map',
	// Choose from Mapbox's core styles, or make your own style with Mapbox Studio
	style: 'mapbox://styles/mapbox/streets-v12',
	center: [12.550343, 55.665957],
	zoom: 8
	});
	 
	// Create a default Marker and add it to the map.
	const marker1 = new mapboxgl.Marker()
	.setLngLat([12.554729, 55.70651])
	.addTo(map);
	 
	// Create a default Marker, colored black, rotated 45 degrees.
	const marker2 = new mapboxgl.Marker({ color: 'black', rotation: 45 })
	.setLngLat([12.65147, 55.608166])
	.addTo(map);
	</script>

  </div>
 

</body>
</html>
